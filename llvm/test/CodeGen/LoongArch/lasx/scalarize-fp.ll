; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py UTC_ARGS: --version 6
; RUN: llc --mtriple=loongarch32 -mattr=+32s,+lasx < %s | FileCheck %s --check-prefixes=CHECK,LA32
; RUN: llc --mtriple=loongarch64 -mattr=+lasx < %s | FileCheck %s --check-prefixes=CHECK,LA64

define <8 x float> @fadd_elt0_v8f32(float %a) nounwind {
; CHECK-LABEL: fadd_elt0_v8f32:
; CHECK:       # %bb.0: # %entry
; CHECK-NEXT:    # kill: def $f0 killed $f0 def $xr0
; CHECK-NEXT:    lu12i.w $a0, 260096
; CHECK-NEXT:    xvreplgr2vr.w $xr1, $a0
; CHECK-NEXT:    xvfadd.s $xr0, $xr0, $xr1
; CHECK-NEXT:    ret
entry:
  %b = insertelement <8 x float> poison, float %a, i32 0
  %c = fadd <8 x float> %b, <float 1.0, float poison, float poison, float poison, float poison, float poison, float poison, float poison>
  ret <8 x float> %c
}

define <4 x double> @fadd_elt0_v4f64(double %a) nounwind {
; LA32-LABEL: fadd_elt0_v4f64:
; LA32:       # %bb.0: # %entry
; LA32-NEXT:    # kill: def $f0_64 killed $f0_64 def $xr0
; LA32-NEXT:    vldi $vr1, -912
; LA32-NEXT:    xvfadd.d $xr0, $xr0, $xr1
; LA32-NEXT:    ret
;
; LA64-LABEL: fadd_elt0_v4f64:
; LA64:       # %bb.0: # %entry
; LA64-NEXT:    # kill: def $f0_64 killed $f0_64 def $xr0
; LA64-NEXT:    lu52i.d $a0, $zero, 1023
; LA64-NEXT:    xvreplgr2vr.d $xr1, $a0
; LA64-NEXT:    xvfadd.d $xr0, $xr0, $xr1
; LA64-NEXT:    ret
entry:
  %b = insertelement <4 x double> poison, double %a, i32 0
  %c = fadd <4 x double> %b, <double 1.0, double poison, double poison, double poison>
  ret <4 x double> %c
}

define <8 x float> @fsub_splat_v8f32(float %a, float %b) nounwind {
; CHECK-LABEL: fsub_splat_v8f32:
; CHECK:       # %bb.0: # %entry
; CHECK-NEXT:    # kill: def $f1 killed $f1 def $vr1
; CHECK-NEXT:    # kill: def $f0 killed $f0 def $vr0
; CHECK-NEXT:    vfsub.s $vr0, $vr0, $vr1
; CHECK-NEXT:    xvpermi.d $xr0, $xr0, 68
; CHECK-NEXT:    xvrepl128vei.w $xr0, $xr0, 0
; CHECK-NEXT:    ret
entry:
  %insa = insertelement <8 x float> poison, float %a, i32 0
  %insb = insertelement <8 x float> poison, float %b, i32 0
  %va = shufflevector <8 x float> %insa, <8 x float> poison, <8 x i32> zeroinitializer
  %vb = shufflevector <8 x float> %insb, <8 x float> poison, <8 x i32> zeroinitializer
  %c = fsub <8 x float> %va, %vb
  ret <8 x float> %c
}

define <4 x double> @fsub_splat_v4f64(double %a) nounwind {
; LA32-LABEL: fsub_splat_v4f64:
; LA32:       # %bb.0: # %entry
; LA32-NEXT:    # kill: def $f0_64 killed $f0_64 def $xr0
; LA32-NEXT:    vldi $vr1, -784
; LA32-NEXT:    xvfadd.d $xr0, $xr0, $xr1
; LA32-NEXT:    xvpermi.d $xr0, $xr0, 68
; LA32-NEXT:    xvrepl128vei.d $xr0, $xr0, 0
; LA32-NEXT:    ret
;
; LA64-LABEL: fsub_splat_v4f64:
; LA64:       # %bb.0: # %entry
; LA64-NEXT:    # kill: def $f0_64 killed $f0_64 def $xr0
; LA64-NEXT:    lu52i.d $a0, $zero, -1025
; LA64-NEXT:    xvreplgr2vr.d $xr1, $a0
; LA64-NEXT:    xvfadd.d $xr0, $xr0, $xr1
; LA64-NEXT:    xvpermi.d $xr0, $xr0, 68
; LA64-NEXT:    xvrepl128vei.d $xr0, $xr0, 0
; LA64-NEXT:    ret
entry:
  %insa = insertelement <4 x double> poison, double %a, i32 0
  %insb = insertelement <4 x double> poison, double 1.0, i32 0
  %va = shufflevector <4 x double> %insa, <4 x double> poison, <4 x i32> zeroinitializer
  %vb = shufflevector <4 x double> %insb, <4 x double> poison, <4 x i32> zeroinitializer
  %c = fsub <4 x double> %va, %vb
  ret <4 x double> %c
}
